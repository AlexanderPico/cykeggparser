package org.cytoscape.keggparser.actions;

import org.cytoscape.application.swing.AbstractCyAction;
import org.cytoscape.keggparser.KEGGParserPlugin;
import org.cytoscape.keggparser.dialogs.KeggWebLoadFrame;
import org.cytoscape.work.AbstractTask;
import org.cytoscape.work.TaskMonitor;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.swing.*;
import java.awt.event.ActionEvent;


public class KeggWebLoadAction extends AbstractCyAction {
    private KeggWebLoadFrame keggWebLoadFrame;
    protected static Logger keggLoadActionLogger = LoggerFactory.getLogger(KeggWebLoadAction.class);

    /**
     * Creates a new HelpContentsAction object.
     */
    public KeggWebLoadAction() {
        super("Load KGML from web");
        setPreferredMenu("Apps.KEGGParser.Load KGML");
    }


    public void actionPerformed(ActionEvent e) {
        try {
            keggWebLoadFrame = KeggWebLoadFrame.getInstance();
        } catch (Exception e1) {
            JOptionPane.showMessageDialog(KEGGParserPlugin.cytoscapeDesktopService.getJFrame(),
                    e1.getMessage());
        }
//        final KeggWebLoadTask task = new KeggWebLoadTask();
//        KEGGParserPlugin.taskManager.execute(new TaskIterator(task));
    }

    private class KeggWebLoadTask extends AbstractTask{
        KeggWebLoadTask(){
            setName("KEGG web-load task");
        }
        @Override
        public void run(TaskMonitor taskMonitor) throws Exception {
            taskMonitor.setProgress(-1);
            try {

                keggWebLoadFrame = KeggWebLoadFrame.getInstance();
            } catch (Exception e) {
                throw new Exception(e.getMessage());
            } finally {
                taskMonitor.setProgress(1);
                System.gc();
            }
        }

    }


}

